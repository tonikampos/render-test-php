<div class="admin-container">
  <header class="page-header">
    <h1>
      <mat-icon>admin_panel_settings</mat-icon>
      Panel de Administración - Reportes Pendientes
    </h1>
    <p>Revisa aquí los reportes enviados por los usuarios.</p>
  </header>

  <div *ngIf="loading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Cargando reportes...</p>
  </div>

  <div *ngIf="!loading && reportes.length > 0">
    <!-- VISTA TABLA DESKTOP -->
    <div *ngIf="!isMobile" class="table-container mat-elevation-z4">
      <table mat-table [dataSource]="reportes">

        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef> ID </th>
          <td mat-cell *matCellDef="let reporte"> #{{reporte.id}} </td>
        </ng-container>

        <ng-container matColumnDef="tipo_contenido">
          <th mat-header-cell *matHeaderCellDef> Tipo </th>
          <td mat-cell *matCellDef="let reporte"> {{reporte.tipo_contenido | titlecase}} </td>
        </ng-container>

        <ng-container matColumnDef="contenido_id">
          <th mat-header-cell *matHeaderCellDef> Contenido ID </th>
          <td mat-cell *matCellDef="let reporte">
            <a *ngIf="reporte.tipo_contenido === 'habilidad'" [routerLink]="['/habilidades', reporte.contenido_id]" target="_blank" matTooltip="Ver habilidad reportada">
              #{{reporte.contenido_id}} <mat-icon inline>open_in_new</mat-icon>
            </a>
            <span *ngIf="reporte.tipo_contenido !== 'habilidad'" matTooltip="ID del {{reporte.tipo_contenido}} reportado">
              #{{reporte.contenido_id}}
            </span>
          </td>
        </ng-container>

        <ng-container matColumnDef="motivo">
          <th mat-header-cell *matHeaderCellDef> Motivo del Reporte </th>
          <td mat-cell *matCellDef="let reporte" class="motivo-cell"> {{reporte.motivo}} </td>
        </ng-container>

        <ng-container matColumnDef="fecha_reporte">
          <th mat-header-cell *matHeaderCellDef> Fecha </th>
          <td mat-cell *matCellDef="let reporte"> {{reporte.fecha_reporte | date:'dd/MM/yy HH:mm'}} </td>
        </ng-container>

        <ng-container matColumnDef="acciones">
          <th mat-header-cell *matHeaderCellDef> Acciones </th>
          <td mat-cell *matCellDef="let reporte" class="acciones-cell">
            <button mat-icon-button color="primary" (click)="abrirDialogoResolver(reporte)" matTooltip="Resolver reporte">
              <mat-icon>gavel</mat-icon> </button>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>

    <!-- VISTA CARDS MÓVIL -->
    <div *ngIf="isMobile" class="mobile-cards-container">
      <div *ngFor="let reporte of reportes; trackBy: trackByReporteId" class="reporte-card mat-elevation-z2">
        <div class="card-header">
          <div class="reporte-tipo">{{ reporte.tipo_contenido | titlecase }}</div>
          <div class="reporte-id">#{{ reporte.id }}</div>
        </div>

        <div class="card-body">
          <div class="motivo-section">
            <div class="label">Motivo del Reporte</div>
            <div class="motivo-text">{{ reporte.motivo }}</div>
          </div>

          <div class="info-grid">
            <div class="info-item">
              <div class="label">Contenido ID</div>
              <div class="value">
                <a *ngIf="reporte.tipo_contenido === 'habilidad'" 
                   [routerLink]="['/habilidades', reporte.contenido_id]" 
                   target="_blank">
                  #{{ reporte.contenido_id }}
                  <mat-icon inline style="font-size: 14px; width: 14px; height: 14px; vertical-align: text-bottom;">open_in_new</mat-icon>
                </a>
                <span *ngIf="reporte.tipo_contenido !== 'habilidad'">
                  #{{ reporte.contenido_id }}
                </span>
              </div>
            </div>

            <div class="info-item">
              <div class="label">Fecha</div>
              <div class="value">{{ reporte.fecha_reporte | date:'dd/MM/yy HH:mm' }}</div>
            </div>
          </div>
        </div>

        <div class="card-actions">
          <button mat-flat-button color="primary" (click)="abrirDialogoResolver(reporte)">
            <mat-icon>gavel</mat-icon> Resolver Reporte
          </button>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!loading && reportes.length === 0" class="no-results">
    <mat-icon>check_circle</mat-icon>
    <h2>¡Todo en orden!</h2>
    <p>No hay reportes pendientes de revisión.</p>
  </div>
</div>