<div class="perfil-container">
  <div *ngIf="usuario; else noUsuario">

    <header class="perfil-header">
      <div class="perfil-info">
        <h1>{{ usuario.nombre_usuario }}</h1>
        <p class="ubicacion">üìç {{ usuario.ubicacion }}</p>
      </div>
    </header>

    <!-- Estad√≠sticas -->
    <section class="stats-section">
      <h2>
        <mat-icon>insights</mat-icon>
        Estad√≠sticas
      </h2>

      <div *ngIf="loadingStats" class="stats-grid">
        <app-skeleton-loader type="stats"></app-skeleton-loader>
        <app-skeleton-loader type="stats"></app-skeleton-loader>
        <app-skeleton-loader type="stats"></app-skeleton-loader>
      </div>

      <div *ngIf="!loadingStats" class="stats-grid">
        <mat-card class="stat-card">
          <mat-icon class="stat-icon habilidades">volunteer_activism</mat-icon>
          <div class="stat-content">
            <h3>{{ stats.totalHabilidades }}</h3>
            <p>Habilidades Ofrecidas</p>
          </div>
        </mat-card>

        <mat-card class="stat-card">
          <mat-icon class="stat-icon intercambios">swap_horiz</mat-icon>
          <div class="stat-content">
            <h3>{{ stats.intercambiosCompletados }}</h3>
            <p>Intercambios Completados</p>
          </div>
        </mat-card>

        <mat-card class="stat-card">
          <mat-icon class="stat-icon valoracion">star</mat-icon>
          <div class="stat-content">
            <h3>{{ stats.valoracionPromedio | number:'1.1-1' }}</h3>
            <div class="estrellas">
              <mat-icon *ngFor="let estrella of getEstrellas(stats.valoracionPromedio)">
                {{ estrella }}
              </mat-icon>
            </div>
            <p>{{ stats.totalValoraciones }} valoraci√≥n{{ stats.totalValoraciones !== 1 ? 'es' : '' }}</p>
          </div>
        </mat-card>
      </div>
    </section>

    <section class="perfil-section">
      <h2>Sobre min</h2>
      <p>{{ usuario.biografia || 'Este usuario a√≠nda non engadiu unha biograf√≠a.' }}</p>
    </section>

    <section class="perfil-section">
      <app-valoraciones-list [valoraciones]="valoraciones"></app-valoraciones-list>
    </section>

  </div>

  <ng-template #noUsuario>
    <div class="loading-container">
      <mat-spinner></mat-spinner>
      <p>Cargando perfil...</p>
    </div>
  </ng-template>
</div>