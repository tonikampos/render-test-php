# API Routing Configuration
# Habilitar rewrite engine
RewriteEngine On
RewriteBase /backend/

# Permitir CORS preflight (OPTIONS)
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# Redirigir todas las peticiones a api/index.php si el archivo no existe
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^api/(.*)$ api/index.php [QSA,L]

# Denegar acceso a archivos sensibles
<FilesMatch "^(database\.php|\.env)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Headers de seguridad
Header set X-Content-Type-Options "nosniff"
Header set X-Frame-Options "DENY"
Header set X-XSS-Protection "1; mode=block"

# Permitir JSON en Content-Type
AddType application/json .json
